# ПРОГНОЗИРОВАНИЕ ОТТОКА КЛИЕНТОВ БАНКА

*Задача: спрогнозировать уйдет клиент из банка или нет.* **В качестве метрики принята мера F1, удовлетворяющее заказчика значение должно быть не меньше 0,59. Также результаты всех моделей оцениваются по ROC-AUC.**

## Данные подробно исследованы и проведена их подготовка.
Проведено 2 вида кодирования: One-Hot Encoding для логистической регрессии и ordinal encoding для деревянных моделей. Данные поделены на трейн/валид/тест в соотношении 60/20/20.
Применено масштабирование признаков с помощью StandardScaler.

### В процессе исследования выявлен дисбаланс классов. 
Одна из учебных подзадач проекта - отработать навыки борьбы с дисбалансом классов, поэтому далее в проекте созданы модели для 4-х случаев:
- с дисбалансом;
- дисбаланс ликвидируется за счет применения атрибута class_weight='balanced';
- дисбаланс ликвидируется за счет техники upsampling;
- дисбаланс ликвидируется за счет техники downsampling.

### Для каждого случая были применены 3 модели:
- логистическая регрессия;
- решающее дерево (с подбором гиперпараметров и без);
- случайный лес  (с подбором гиперпараметров и без).

**По итогу исследования лучшие результаты дал случайный лес с настроенными гиперпараметрами и со взвешенными классами:  F1 = 0.632, AUC-ROC = 0.869.**

## Библиотеки
* pandas
* matplotlib.pyplot
* sklearn
* numpy
* seaborn
* plotly

