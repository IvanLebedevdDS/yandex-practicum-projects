# Восстановление золота из руды

*Задача: подготовить прототип модели машинного обучения для предсказания коэффициента восстановления золота из золотосодержащей руды.*

Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

Необходимо предсказать коэффициент восстановления как после этапа флотации, так и на финальном этапе. Для оценки работы модели применяется метрика *sMAPE*.

## Проведены исследование и предобработка данных
1.	Выявлено и объяснено отсутствие ряда признаков в тестовой выборке. Основная причина – они характеризуют готовый продукт на определенной стадии, что никак не может быть получено во время технологического процесса.
2.	Выявлены и обработаны пропуски. Пропуски в обучающих признаках в полном датасете заполнены ближними данными методом ffill, в тестовом и обучающем наборах – заполнены из полной выборки методом update. Пропуски в целевых признаках удалены.
3.	Выявлены нулевые значения в целевых признаках. Такие значения приняты некорректными, строки с ними удалены.
4.	В тестовую выборку добавлены целевые признаки.
5.	Выполнена проверка расчитанной в датасете эффективности обогащения. Получено пренебрежительно малое MAE, которое подтвердило правильность рассчитанных признаков.

Выявлены изменения концентраций каждого материала в зависимости от этапа.

AU - золото. Концентрация золота закономерно возрастает от начального к конечному этапу - средние значения на финальном этапе находятся в районе 45 %, а это является самой большой величиной в концентрате. Изменение этих боксплотов закономерно показывает, что процесс идет успешно.

AG - серебро. Концентрация серебра планомерно снижается в процессе обогащения, скорей всего происходит его вымывание из раствора на различных стадиях процесса. На финальном этапе среднее значение концентрации данного материала составляет около 5 %.

PB - свинец. Концентрация свинца меняется незначительно в процессе обогащения, средние значения изменяются от 7.5 до 10 %. Предположительно, в процессе первичной очистки в раствор искусственно добавляется данный материал и далее не меняется.

SOL - прочие примеси. Содержание прочих примесей особо велико после флотации, но при первичной очистке оно резко падает (средние значения уменьшаются в 3 раза), вторичная очистка не дает такого эффекта и содержание примесей в растворе почти не меняется.

## Была проведена подготовка служебных функций для моделирования
- ф-я расчета sMAPE;
- ф-я для проведения кросс-валидации;
- ф-я для проведения моделирования и расчета sMAPE сразу для всех этапов.

## Проведено моделирование с помощью слудющих алгоритмов:
- линейная регрессия;
- решающее дерево;
- случайный лес.

Результаты моделей были сравнены с дамми регрессором.

Наилучшей моделью оказался случайный лес с 30 деревьями и глубиной 4. Финальная sMAPE для данной модели на тестовой выборке составила 7.4.

## Библиотеки и методы
* pandas
* matplotlib
* seaborn
* sklearn
* cross-validation
* sMAPE
* numpy
* boxplot
