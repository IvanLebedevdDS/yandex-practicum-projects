# Предсказание температуры стали (выпускной проект)

*Задача: построить модель, которая предскажет финальную температуру стали перед ее подачей в машину непрерывной заливки.*

В **первой части** проекта было проведено исследование и предобработка всех предоставленных датасетов.
По результатам исследования было выявлено и выполнено следующее:
1. В данных по работе электродов было расчитано время каждого нагрева.
2. На основе данных о времени каждого нагрева и зафиксрованных мощностей посчитана потребленная электроэнергия в КВА*ч.
3. Посчитанная потребленная электроэнергия была сгруппирована по 3214 партиям, т.о. был получен первый признак для наших моделей.
4. Были рассмотрены данные о сыпучих и проволочных материалах. В данных об объемах было выявлено много пропусков, что означает, что данные материалы не добавлялись в текущую партию, поэтому пропуски в датасетах с объемами были заменены на 0.
5. Также были оценены данные по времени добавления присадок. Выявлена та же структура данных, что и у объемов. Был сделан вывод, что использование данных со временем не требуется, т.к. в рамках проекта не решается задача временных рядов.
6. Была проведена оценка с данных о добавлении газа. Данные имеют нормальное распределение и имеются практически для всех партий, содержащихся в датасете (3239 партий).
7. Был проведен анализ измеренных в ходе технологического процесса температур, в результате которого выявлены явные выбросы ниже 1400 градусов, а также ряд партий с всего 1 измерением. По информации от заказчика такие партии не должны рассматриваться в проекте, поэтому были исключены.
8. Все значения температур были сгруппированы по партиям, при этом в качестве одного из обучающих признаков взято первое измеренное значение, а в качестве таргета - последнее измеренное значение.
9. В качестве завершающего этапа по предобработке данных все датасеты были объединены в один общий. При этом партии, по которым есть данные о температуре, но нет каких либо других данных были исключены из датасета.

Во **второй части** проекта была проведена подготовка выборок и дальнейшее обучение моделей. Было сделано следующее:
1. Была выявлена сильная взаимосвязь между признаками Bulk 9 и Wire 8 (коэффициент корреляции равен 0.974969), поэтому один из признаков (Bulk 9) был исключен из датасета.
2. Также были исключены из общего датасета данные по партиям и количеству замеров по температуре.
3. Для всех моделей был применен поиск оптимальных параметров с помощью GridSearchCV и кросс-валидации с 5 фолдами.
4. Была обучена модель линейной регрессии: получен MAE=7.647 с параметрами fit_intercept': True, 'normalize': False.
5. Была обучена модель случайного леса: получен MAE=6.178 с параметрами max_depth : 10, 'n_estimators' : 70.
6. Была обучена модель LightGBM: получен MAE=6.147 с параметрами 'learning_rate': 0.04, 'n_estimators': 100, 'num_leaves': 21.
7. Была обучена модель CatBoost: получен МАЕ=5.99243467082956 с параметрами 'iterations': 500, 'learning_rate': 0.03.

В **третьей части** проекта каждая модель была проверена на отложенной тестовой выборке. По итогу тестирования наилучшие результаты (МАЕ = 6.012) были получены с помощью модели CatBoostRegressor с подобранными гиперпараметрами iterations = 500 и learning_rate = 0.03.

## Библиотеки и методы
* pandas
* matplotlib
* seaborn
* sklearn
* cross-validation
* numpy
* LightGBM
* CatBoost
